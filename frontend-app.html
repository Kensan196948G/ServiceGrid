<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ITSM運用システム</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/react-router-dom@6/dist/umd/react-router-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      font-family: system-ui, -apple-system, sans-serif; 
      margin: 0; 
      background: #f8fafc;
    }
    .loading { 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      height: 100vh; 
      flex-direction: column;
    }
  </style>
</head>
<body>
  <div id="root">
    <div class="loading">
      <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mb-4"></div>
      <p class="text-xl text-slate-700">ITSM運用システム読み込み中...</p>
    </div>
  </div>

  <script type="text/babel">
    const { useState, useEffect, createContext, useContext } = React;
    const { HashRouter, Routes, Route, Navigate, useNavigate } = ReactRouterDOM;

    // Simple Auth Context
    const AuthContext = createContext();

    const AuthProvider = ({ children }) => {
      const [user, setUser] = useState(null);
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);

      // Check for existing session on load
      useEffect(() => {
        const savedUser = sessionStorage.getItem('itsm_user');
        if (savedUser) {
          try {
            setUser(JSON.parse(savedUser));
          } catch (e) {
            sessionStorage.removeItem('itsm_user');
          }
        }
      }, []);

      const login = async (username, password) => {
        setError(null);
        setIsLoading(true);
        
        // Mock authentication with realistic delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        if ((username === 'admin' && password === 'admin123') || 
            (username === 'operator' && password === 'operator123')) {
          const userData = { 
            username, 
            role: username === 'admin' ? 'ADMIN' : 'USER',
            id: username === 'admin' ? '1' : '2',
            email: username === 'admin' ? 'admin@company.com' : 'operator@company.com'
          };
          setUser(userData);
          sessionStorage.setItem('itsm_user', JSON.stringify(userData));
          setIsLoading(false);
          return true;
        } else {
          setError('ユーザー名またはパスワードが正しくありません');
          setIsLoading(false);
          return false;
        }
      };

      const logout = () => {
        setUser(null);
        setError(null);
        sessionStorage.removeItem('itsm_user');
      };

      return React.createElement(AuthContext.Provider, {
        value: { user, login, logout, isLoading, error }
      }, children);
    };

    const useAuth = () => useContext(AuthContext);

    // Login Page Component
    const LoginPage = () => {
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const { login, error, isLoading } = useAuth();
      const navigate = useNavigate();

      const handleSubmit = async (e) => {
        e.preventDefault();
        const success = await login(username, password);
        if (success) {
          navigate('/dashboard');
        }
      };

      return React.createElement('div', {
        className: 'min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4'
      }, 
        React.createElement('div', {
          className: 'w-full max-w-md bg-white rounded-lg shadow-2xl p-8'
        }, [
          React.createElement('div', { key: 'header', className: 'text-center mb-8' }, [
            React.createElement('div', { 
              key: 'icon',
              className: 'w-20 h-20 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl'
            }, '🔒'),
            React.createElement('h1', { 
              key: 'title',
              className: 'text-2xl font-bold text-slate-800 mb-1' 
            }, 'ITSM運用システム'),
            React.createElement('p', { 
              key: 'subtitle',
              className: 'text-sm text-slate-600' 
            }, 'プラットフォーム'),
            React.createElement('div', {
              key: 'divider',
              className: 'w-16 h-0.5 bg-gradient-to-r from-blue-600 to-indigo-600 mx-auto mt-4'
            })
          ]),
          React.createElement('form', {
            key: 'form',
            onSubmit: handleSubmit,
            className: 'space-y-5'
          }, [
            React.createElement('div', { key: 'username-field' }, [
              React.createElement('label', {
                key: 'username-label',
                className: 'block text-sm font-medium text-slate-700 mb-2'
              }, 'ユーザー名'),
              React.createElement('input', {
                key: 'username-input',
                type: 'text',
                value: username,
                onChange: (e) => setUsername(e.target.value),
                className: 'w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all',
                placeholder: 'ユーザー名を入力',
                required: true,
                disabled: isLoading
              })
            ]),
            React.createElement('div', { key: 'password-field' }, [
              React.createElement('label', {
                key: 'password-label',
                className: 'block text-sm font-medium text-slate-700 mb-2'
              }, 'パスワード'),
              React.createElement('input', {
                key: 'password-input',
                type: 'password',
                value: password,
                onChange: (e) => setPassword(e.target.value),
                className: 'w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all',
                placeholder: 'パスワードを入力',
                required: true,
                disabled: isLoading
              })
            ]),
            React.createElement('div', {
              key: 'test-accounts',
              className: 'bg-blue-50 border border-blue-200 rounded-lg p-4'
            }, [
              React.createElement('div', { key: 'test-header', className: 'flex items-center mb-2' }, [
                React.createElement('span', { key: 'icon', className: 'text-blue-600 mr-2' }, 'ℹ️'),
                React.createElement('p', { key: 'title', className: 'font-medium text-blue-800 text-sm' }, 'テストアカウント:')
              ]),
              React.createElement('div', { key: 'accounts', className: 'text-xs text-blue-700 space-y-1' }, [
                React.createElement('p', { key: 'admin' }, '管理者: admin / admin123'),
                React.createElement('p', { key: 'operator' }, 'オペレータ: operator / operator123')
              ])
            ]),
            error && React.createElement('div', {
              key: 'error',
              className: 'bg-red-50 border border-red-200 rounded-lg p-4 flex items-center'
            }, [
              React.createElement('span', { key: 'error-icon', className: 'text-red-500 mr-2' }, '⚠️'),
              React.createElement('span', { key: 'error-text', className: 'text-sm text-red-800' }, error)
            ]),
            React.createElement('button', {
              key: 'submit',
              type: 'submit',
              disabled: !username || !password || isLoading,
              className: 'w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 px-4 rounded-lg hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 disabled:transform-none shadow-lg font-medium'
            }, [
              isLoading && React.createElement('span', {
                key: 'spinner',
                className: 'inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2'
              }),
              isLoading ? 'ログイン中...' : 'ログイン'
            ])
          ])
        ])
      );
    };

    // Sidebar Navigation Component
    const Sidebar = () => {
      const { logout, user } = useAuth();
      const navigate = useNavigate();

      const menuItems = [
        { name: 'ダッシュボード', path: '/dashboard', icon: '📊' },
        { name: 'インシデント', path: '/incidents', icon: '🚨' },
        { name: '資産管理', path: '/assets', icon: '💻' },
        { name: 'サービス要求', path: '/requests', icon: '📝' },
        { name: 'ナレッジ', path: '/knowledge', icon: '📚' },
        { name: '変更管理', path: '/changes', icon: '🔄' },
        { name: 'リリース管理', path: '/releases', icon: '🚀' },
        { name: '設定', path: '/settings', icon: '⚙️' }
      ];

      return React.createElement('div', {
        className: 'w-64 bg-slate-800 text-white min-h-screen flex flex-col'
      }, [
        React.createElement('div', {
          key: 'header',
          className: 'p-6 border-b border-slate-700'
        }, [
          React.createElement('h2', {
            key: 'title',
            className: 'text-xl font-bold'
          }, 'ITSM運用システム'),
          React.createElement('p', {
            key: 'user',
            className: 'text-sm text-slate-300 mt-1'
          }, `ようこそ、${user?.username}さん`)
        ]),
        React.createElement('nav', {
          key: 'nav',
          className: 'flex-1 p-4'
        }, 
          React.createElement('ul', {
            className: 'space-y-2'
          }, menuItems.map(item => 
            React.createElement('li', {
              key: item.path
            },
              React.createElement('a', {
                href: `#${item.path}`,
                className: 'flex items-center px-4 py-3 rounded-lg hover:bg-slate-700 transition-colors',
                onClick: () => navigate(item.path)
              }, [
                React.createElement('span', {
                  key: 'icon',
                  className: 'mr-3 text-lg'
                }, item.icon),
                React.createElement('span', {
                  key: 'name'
                }, item.name)
              ])
            )
          ))
        ),
        React.createElement('div', {
          key: 'footer',
          className: 'p-4 border-t border-slate-700'
        },
          React.createElement('button', {
            onClick: logout,
            className: 'w-full flex items-center px-4 py-3 rounded-lg hover:bg-slate-700 transition-colors text-left'
          }, [
            React.createElement('span', {
              key: 'icon',
              className: 'mr-3 text-lg'
            }, '🚪'),
            React.createElement('span', {
              key: 'text'
            }, 'ログアウト')
          ])
        )
      ]);
    };

    // Main Layout Component
    const MainLayout = ({ children }) => {
      return React.createElement('div', {
        className: 'flex min-h-screen bg-slate-50'
      }, [
        React.createElement(Sidebar, { key: 'sidebar' }),
        React.createElement('div', {
          key: 'content',
          className: 'flex-1 flex flex-col'
        }, children)
      ]);
    };

    // Dashboard Page Component
    const DashboardPage = () => {
      const { user } = useAuth();
      
      const stats = [
        { title: 'インシデント', count: '24', label: 'オープン中', color: 'blue', icon: '🚨' },
        { title: '資産', count: '342', label: '管理中', color: 'green', icon: '💻' },
        { title: 'サービス要求', count: '15', label: '承認待ち', color: 'yellow', icon: '📝' },
        { title: 'システム可用性', count: '99.8%', label: '今月の稼働率', color: 'green', icon: '📊' }
      ];

      return React.createElement(MainLayout, {}, [
        React.createElement('div', {
          key: 'header',
          className: 'bg-white shadow border-b border-slate-200'
        }, 
          React.createElement('div', {
            className: 'px-6 py-4'
          },
            React.createElement('h1', {
              className: 'text-2xl font-bold text-slate-800'
            }, 'ダッシュボード')
          )
        ),
        React.createElement('div', {
          key: 'content',
          className: 'flex-1 p-6'
        }, [
          React.createElement('div', {
            key: 'welcome',
            className: 'bg-white rounded-lg shadow p-6 mb-6'
          }, [
            React.createElement('h2', {
              key: 'title',
              className: 'text-xl font-semibold text-slate-800 mb-2'
            }, `ようこそ、${user?.username}さん`),
            React.createElement('p', {
              key: 'description',
              className: 'text-slate-600'
            }, 'ITSM運用システムのダッシュボードです。システムの状況を一目で確認できます。')
          ]),
          React.createElement('div', {
            key: 'stats',
            className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6'
          }, stats.map(stat => 
            React.createElement('div', {
              key: stat.title,
              className: 'bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow'
            }, [
              React.createElement('div', {
                key: 'header',
                className: 'flex items-center justify-between mb-4'
              }, [
                React.createElement('h3', {
                  key: 'title',
                  className: 'text-lg font-medium text-slate-800'
                }, stat.title),
                React.createElement('span', {
                  key: 'icon',
                  className: 'text-2xl'
                }, stat.icon)
              ]),
              React.createElement('p', {
                key: 'count',
                className: `text-3xl font-bold text-${stat.color}-600 mb-1`
              }, stat.count),
              React.createElement('p', {
                key: 'label',
                className: 'text-sm text-slate-500'
              }, stat.label)
            ])
          )),
          React.createElement('div', {
            key: 'recent',
            className: 'bg-white rounded-lg shadow p-6'
          }, [
            React.createElement('h3', {
              key: 'title',
              className: 'text-lg font-medium text-slate-800 mb-4'
            }, '最近の活動'),
            React.createElement('div', {
              key: 'activities',
              className: 'space-y-3'
            }, [
              { time: '10:30', desc: '新しいインシデント #INC-2024-001 が作成されました', type: 'incident' },
              { time: '09:15', desc: 'サーバー #SRV-001 の定期メンテナンスが完了しました', type: 'maintenance' },
              { time: '08:45', desc: 'ユーザー john.doe からサービス要求 #REQ-2024-045 が提出されました', type: 'request' }
            ].map((activity, index) => 
              React.createElement('div', {
                key: index,
                className: 'flex items-start space-x-3 p-3 rounded-lg bg-slate-50'
              }, [
                React.createElement('span', {
                  key: 'time',
                  className: 'text-sm text-slate-500 font-mono w-12'
                }, activity.time),
                React.createElement('span', {
                  key: 'desc',
                  className: 'text-sm text-slate-700'
                }, activity.desc)
              ])
            ))
          ])
        ])
      ]);
    };

    // Protected Route Component
    const ProtectedRoute = ({ children }) => {
      const { user } = useAuth();
      return user ? children : React.createElement(Navigate, { to: '/login', replace: true });
    };

    // Main App Component
    const App = () => {
      return React.createElement(AuthProvider, {},
        React.createElement(HashRouter, {},
          React.createElement(Routes, {}, [
            React.createElement(Route, {
              key: 'login',
              path: '/login',
              element: React.createElement(LoginPage)
            }),
            React.createElement(Route, {
              key: 'dashboard',
              path: '/dashboard',
              element: React.createElement(ProtectedRoute, {},
                React.createElement(DashboardPage)
              )
            }),
            React.createElement(Route, {
              key: 'root',
              path: '/',
              element: React.createElement(Navigate, { to: '/dashboard', replace: true })
            }),
            React.createElement(Route, {
              key: 'fallback',
              path: '*',
              element: React.createElement(Navigate, { to: '/dashboard', replace: true })
            })
          ])
        )
      );
    };

    // Render the app
    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>